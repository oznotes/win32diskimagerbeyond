================================================================================
                    Win32 Disk Imager Beyond - Changelog
================================================================================

Version 1.0.3 (2025-12)
--------------------------------------------------------------------------------

CRITICAL FIXES:
  - Fixed arithmetic overflow in sector calculations for disks >4GB
  - Fixed use-after-free in QByteArray::fromRawData (changed to deep copy)
  - Fixed division by zero in getNumberOfSectors
  - Fixed buffer overflow in volume name construction
  - Fixed uninitialized bytesread variable causing data corruption
  - Fixed memory leak in on_bDetect_clicked partition check
  - Fixed getDeviceID uninitialized data access

MEMORY LEAKS FIXED:
  - TestModel objects leaked in partition detection loop
  - sectorData leaked on error paths in read/write/verify
  - slashify() allocation leak on error
  - sectorData2 uninitialized pointer in destructor
  - QFile not closed after hash generation

HANDLE LEAKS FIXED:
  - hFile leak in on_bWrite_clicked error paths
  - hFile leak in on_bRead_clicked error paths
  - hVolume leak in on_bVerify_clicked error paths
  - hRawDisk double cleanup with INVALID_HANDLE_VALUE
  - Debug log file handle never closed

INTEGER OVERFLOW PROTECTION:
  - Added overflow check in sector size calculations
  - Added qint64->int bounds check in blob.mid()
  - Added FLASHTYPE multiplication overflow protection
  - Fixed progressbar range overflow (numsectors > INT_MAX)
  - Fixed integer overflow in ElapsedTimer for long operations

LOGIC BUGS FIXED:
  - spaceAvailable() returned TRUE on error (now returns FALSE)
  - DBTF_NET flag check was always true
  - QString NULL comparison (now uses isEmpty())
  - indexOf(-1) validation before truncate
  - Degenerate loop executing only once

SAFETY IMPROVEMENTS:
  - Added QString.at() bounds checks (4 locations)
  - Added QTextCodec NULL check with Latin-1 fallback
  - Added clipboard null check before setText
  - Added pDevDesc null check in enumeratePhysicalDrives
  - Added TestModel virtual destructor
  - Added TestModel::data() row bounds validation
  - Fixed unaligned memory access using memcpy
  - Fixed unsafe sprintf() usage with _snprintf_s

CODE QUALITY:
  - Removed dead isDriveVirtual() function
  - Removed commented/dead code blocks
  - Added default case in nativeEvent switch
  - Fixed memcmp return type (int, not unsigned long long)
  - Initialized pID variable
  - Fixed partial read/write validation

UI CHANGES:
  - Version number now displayed in window title bar
  - Fixed text clipping on high DPI displays (GroupBox title descenders cut off)
    Replaced QGroupBox titles with QLabel widgets to bypass Qt rendering bug

GUI MODERNIZATION (Windows 11 Style):
  - NEW: Modern QSS stylesheet with Fluent Design aesthetics
  - Accent color theme (#0078d4 blue) for primary actions
  - Rounded corners (3px) on buttons, inputs, and progress bars
  - Hover/pressed/disabled states for all interactive elements
  - Read/Write buttons styled as primary actions with accent background
  - Monospace font (Consolas) for hash display
  - Modern table view styling with subtle gridlines
  - Checkbox styling with accent color when checked
  - Status bar with subtle top border

LAYOUT IMPROVEMENTS:
  - Window now resizable (was fixed size)
  - Minimum window size increased: 425x300 -> 520x400 pixels
  - Improved margins (8px left, 12px top/right, 8px bottom)
  - Consistent 6px spacing between elements
  - Better visual hierarchy with grouped controls

TIMER DISPLAY:
  - New format: "00:00:00" (hours:minutes:seconds)
  - Always visible in status bar (removed show/hide)
  - Tooltip shows "Elapsed Time"
  - Migrated from deprecated QTime to QElapsedTimer

DEVICE DROPDOWN:
  - Shows device size in GB for easier identification

BUILD & RELEASE (December 2024):
  - 64-bit (x64) build support with MSVC2019/Qt 5.15.0
  - Debug logging disabled by default (wrapped in #ifdef DEBUG_LOGGING)
  - Fixed compiler warning C4101: removed unused cbBytesReturned variable
  - Fixed compiler warning C4267: changed int to size_t for strlen result
  - Updated copyright to 2009-2026
  - windeployqt release packaging


Version 1.0.2
--------------------------------------------------------------------------------
  - Initial "Beyond" edition release
  - eMMC/SD partition detection
  - GPT/MBR partition table support
  - UFS device detection


Release 1.0.1 Beyond
=============
Added ignored_drives.cfg config file to skip/ignore/blacklist drives (subst, virtual, network)
[Workaround for bugs #41 and #47]


Release 1.0.0
=============
Add Verify Image function
Added SHA1 and SHA256 checksums
Read Only Allocated Partitions
Save last opened folder
Additional language translations and translation files location change
Detect and disable USB Floppy (for now)
Updated Innosetup for Windows 10 compatibility
Updated QT/MinGW for Windows 10 compatibility/bug fixes

Bug fixes:
LP: 1285238 - Need to check filename text box for valid filename (not just a directory).
LP: 1323876 - Installer doesn't create the correct permissions on install
LP: 1330125 - Multi-partition SD card only partly copied
SF:  7 - Windows 8 x64 USB floppy access denied. Possibly imaging C drive
SF:  8 - Browse Dialog doesnt open then crashes application
SF:  9 - Cannot Read SD Card
SF: 13 - 0.9.5 version refuses to open read-only image
SF: 15 - Open a image for write, bring window in the background
SF: 27 - Error1: Incorrect function
SF: 35 - Mismatch between allocating and deleting memory buffer
SF: 39 - Miswrote to SSD
SF: 40 - Disk Imager scans whole %USERPROFILE% on start
SF: 45 - Translation files adustment


Release 0.9.5
=============
Update copyright headers, bump for point release
Fixed broken translation (caused build error).
Converted build environment to QT 5.2/Mingw 4.8
Added Italian translation (LP#1270388)
Added translations.
Start work on installer with Innosetup.


Release 0.9
===========
Added custom file dialog window.

Bug fixes:
LP:1118217 - can not select SD card to write image to.
LP:1191156 - File-open dialog does not accept non-existing *.img files as targets.


Release 0.8
===========
Added drag and drop - Drag a file from Windows Explorer and drop it in the
text window.
Added DiskImagesDir environment variable for default images directory.
Improved startup Downloads directory search.
Add copy button for MD5.

Bug fixes:
LP:1080880 Add a copy button for MD5.
LP:1157849 - Partial sectors not written.
LP:1117840 Initial startup can take a long time (+20s) due to the "Downloads" find routine.
LP:1118349 Application does not start.
LP:1157849 Partial sectors not written.
SF:1 Application doesn't start. No window appears.
SF:3 No support of Russian characters in image file path
SF:5 Very long app opening time


Release 0.7
===========
Added default directory path pointing to the user's download directory.
Fixed permission settings to require administrator privileges in Vista/7
Reinstated DiskImager.rc rc file (qmake method lost too many options - may revisit later).
Make MD5Sum selectable for copying.  Fixes LP:1080880.
Add version info to the main window.
Cleanup, move winver resources to project file.
Renamed base translation for English.
More translation updates, minor cleanup.
Added translation capabilities.  Cleaned up some code formatting (broke up long lines).
Testing changes for UTF16 support.
Clean up mixed indentation types, some minor code cleanup.  no functional changes.
Updating the 'driveLabel' stuff to use QString rather than char * on a suggestion from Roland Rudenauer

Bug fixes:
Fixed LP:1100228 "An error occurred while accessing the device. Error1: Incorrect function"
Fixed LP:1102608 "Cannot load images from network shares"
Fixed LP:1095038 "Error message encoding is messed up"
Fixed LP:984510  "Cannot select Device"
Fixed LP:923719  "An error occurred while accessing the device. Error1: Incorrect function"
Fixed LP:985080  "C: with windows 7 partition erased with all data" (NOT FULLY VERIFIED)
fixing memory leak

================================================================================
